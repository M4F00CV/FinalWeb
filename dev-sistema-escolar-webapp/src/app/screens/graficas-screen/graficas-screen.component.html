<div class="wrapper main-content-graficas">
  <div class="section-home">
    <div class="header-home"></div>
    
    <!-- Cuerpo principal -->
    <div class="body-home">
      
      <!-- Título de la pantalla -->
      <div class="row mt-5 mb-5">
        <div class="col-12">
          <span class="title-perfil">Análisis De Datos Del Sistema</span>
        </div>
      </div>

      <div class="container">
        
        <!-- SECCIÓN 1: EVENTOS ACADÉMICOS (Datos estáticos) -->
        <div class="row mt-3 mb-5" style="text-align: center;">
          <div class="col-12">
            <div class="alert alert-primary" role="alert">
              <span class="title-table">Análisis De Eventos Académicos</span>
            </div>
          </div>
        </div>

        <div class="graph-section">
          <div class="graph">
            <!-- Gráfica de Líneas -->
            <canvas
              baseChart
              type="line"
              [data]="lineChartData"
              [plugins]="lineChartPlugins"
              [options]="lineChartOption">
            </canvas>
          </div>
          <div class="graph">
            <!-- Gráfica de Barras -->
            <canvas
              baseChart
              type="bar"
              [data]="barChartData"
              [plugins]="barChartPlugins"
              [options]="barChartOption">
            </canvas>
          </div>
        </div>

        <!-- SECCIÓN 2: ANÁLISIS DE USUARIOS (Datos dinámicos del Backend) -->
        <div class="row mt-3 mb-5" style="text-align: center;">
          <div class="col-12">
            <div class="alert alert-primary" role="alert">
              <span class="title-table">Análisis De Usuarios</span>
            </div>
          </div>
        </div>

        <!-- INDICADOR DE CARGA: Se muestra mientras isDataLoaded es falso -->
        <div *ngIf="!isDataLoaded" class="d-flex justify-content-center align-items-center py-5" style="min-height: 300px;">
           <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
             <span class="visually-hidden">Cargando datos...</span>
           </div>
           <span style="margin-left: 15px; font-family: 'Nexa-Bold'; color: #23395d;">Cargando gráficas...</span>
        </div>

        <!-- CONTENEDOR DE GRÁFICAS: Se muestra SOLO cuando isDataLoaded es verdadero -->
        <div class="user-section" *ngIf="isDataLoaded">
          <div class="graph">
            <!-- Gráfica de Pastel -->
            <canvas
              baseChart
              type="pie"
              [data]="pieChartData"
              [plugins]="pieChartPlugins"
              [options]="pieChartOption">
            </canvas>
          </div>
          <div class="graph">
            <!-- Gráfica Doughnut -->
            <canvas
              baseChart
              type="doughnut"
              [data]="doughnutChartData"
              [plugins]="doughnutChartPlugins"
              [options]="doughnutChartOption">
            </canvas>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>